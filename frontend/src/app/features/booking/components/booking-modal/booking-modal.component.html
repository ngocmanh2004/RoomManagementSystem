<div class="modal-overlay" *ngIf="isOpen" (click)="close()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Đặt thuê phòng</h2>
      <button class="close-btn" (click)="close()">
        <i class="fa-solid fa-times"></i>
      </button>
    </div>

    <div class="modal-body">
      <div class="room-info" *ngIf="room">
        <h3>{{ room.name }}</h3>
        <p class="room-price">{{ room.price | number }}đ/tháng</p>
      </div>

      <form [formGroup]="bookingForm" (ngSubmit)="submit()">
        <div class="form-group">
          <label>Họ và tên *</label>
          <input type="text" class="form-control" formControlName="fullName" placeholder="Nhập họ và tên">
          <small class="error-text" *ngIf="fullNameError">{{ fullNameError }}</small>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>CCCD/CMND *</label>
            <input type="text" class="form-control" formControlName="cccd" placeholder="123456789">
            <small class="error-text" *ngIf="cccdError">{{ cccdError }}</small>
          </div>

          <div class="form-group">
            <label>Số điện thoại *</label>
            <input type="tel" class="form-control" formControlName="phone" placeholder="0909000001">
            <small class="error-text" *ngIf="phoneError">{{ phoneError }}</small>
          </div>
        </div>

        <div class="form-group">
          <label>Địa chỉ hiện tại *</label>
          <input type="text" class="form-control" formControlName="address" placeholder="Nhập địa chỉ hiện tại">
          <small class="error-text" *ngIf="addressError">{{ addressError }}</small>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Ngày bắt đầu *</label>
            <input type="date" class="form-control" formControlName="startDate">
            <small class="error-text" *ngIf="startDateError">{{ startDateError }}</small>
          </div>

          <div class="form-group">
            <label>Ngày kết thúc (tuỳ chọn)</label>
            <input type="date" class="form-control" formControlName="endDate">
          </div>
        </div>

        <div class="form-group">
          <label>Tiền cọc (VNĐ) *</label>
          <input type="number" class="form-control" formControlName="deposit" placeholder="0">
          <small class="error-text" *ngIf="depositError">{{ depositError }}</small>
        </div>

        <div class="form-group">
          <label>Ghi chú thêm (tuỳ chọn)</label>
          <textarea class="form-control" formControlName="notes" placeholder="Viết ghi chú thêm..." rows="3"></textarea>
        </div>

        <div class="alert alert-danger" *ngIf="errorMessage">
          <i class="fa-solid fa-circle-exclamation"></i> {{ errorMessage }}
        </div>

        <div class="alert alert-success" *ngIf="successMessage">
          <i class="fa-solid fa-check-circle"></i> {{ successMessage }}
        </div>

        <div class="form-actions">
          <button type="button" class="btn btn-secondary" (click)="close()" [disabled]="isSubmitting">
            Hủy
          </button>
          <button type="submit" class="btn btn-primary" [disabled]="isSubmitting || !bookingForm.valid">
            <span *ngIf="isSubmitting">
              <i class="fa-solid fa-spinner fa-spin"></i> Đang xử lý...
            </span>
            <span *ngIf="!isSubmitting">Gửi yêu cầu</span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
